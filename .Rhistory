library(dplyr)
library(tidyverse)
library(hrbrthemes)
library(brms)
library(lme4)
library(lmtest)
library(sandwich)
source("function/marascuillo.R")
setwd("~/Desktop/School/research/gender/gender/")
library(dplyr)
library(tidyverse)
library(hrbrthemes)
library(brms)
library(lme4)
library(lmtest)
library(sandwich)
source("function/marascuillo.R")
tier_longer_loc <- "data/processed/tier_longer.csv"
tier_long <- read.csv2(tier_longer_loc, header=TRUE, sep=",")
# Faculty
fac_loc <- "data/processed/faculty.csv"
fac <- read.csv2(fac_loc, header=TRUE, sep=",")
fac$X[1] <- "eng"
tier_long$tier <- seq(1,8)
tier_long$med <- c(0,0,0,0,0,0,1,1)
tier_long$mid <- c(0,0,0,1,1,1,0,0)
tier_long$high<- c(1,1,1,0,0,0,0,0)
tier_long$rank <- c(1,1,1,2,2,2,3,3)
tier_long$study <- c(1,1,1,1,1,1,0,0)
fac_prop_test <- prop.test(fac$Female, fac$Total)
z_output <- matrix(0, nrow(fac), nrow(fac))
for(i in 1:nrow(fac)){
for(j in 1:nrow(fac)){
if(i != j){
test <- prop.test(c(fac$Female[i], fac$Female[j]), c(fac$Total[i], fac$Total[j]))
z_output[i,j] = test$p.value
}
}
}
z_diag_removed <- z_output
diag(z_diag_removed) = NA
p_adj <- p.adjust(z_diag_removed, method="bonferroni")
p_adj <- matrix(p_adj, nrow=14, ncol=14)
p_adj_df <- data.frame(p_adj)
p_adj_df
p_adj <- p.adjust(z_diag_removed, method="holm")
p_adj <- matrix(p_adj, nrow=14, ncol=14)
p_adj_df <- data.frame(p_adj)
p_adj_df
View(tier_long)
View(fac_prop_test)
View(fac)
power.prop.test(0.2, 0.6, power=0.8)
power.prop.test(0.1, 0.6, power=0.8)
power.prop.test(0.1, 0.2, power=0.8)
power.prop.test(n=100,p1=.2,p2=.1)
power.prop.test(p1=.2,p2=.1,power=.8)
power.prop.test(p1=.6,p2=.1,power=.8)
tr <- power.prop.test(p1=.6,p2=.1,power=.8)
tr$n
z_output <- matrix(0, nrow(fac), nrow(fac))
sample_size <- matrix(0, nrow(fac), nrow(fac))
effective_or_not <- matrix(0, nrow(fac), nrow(fac))
for(i in 1:nrow(fac)){
for(j in 1:nrow(fac)){
if(i != j){
ss_estimate <- power.prop.test(p1 = fac$Female[i]/fac$Total[i], p2 = fac$Female[j]/fac$Total[j], power=0.8)
effective_or_not <-fac$Total[i] > ss_estimate$n & fac$Total[j] > ess_estimate$n
test <- prop.test(c(fac$Female[i], fac$Female[j]), c(fac$Total[i], fac$Total[j]))
z_output[i,j] = test$p.value
}
}
}
z_output <- matrix(0, nrow(fac), nrow(fac))
sample_size <- matrix(0, nrow(fac), nrow(fac))
effective_or_not <- matrix(0, nrow(fac), nrow(fac))
for(i in 1:nrow(fac)){
for(j in 1:nrow(fac)){
if(i != j){
ss_estimate <- power.prop.test(p1 = fac$Female[i]/fac$Total[i], p2 = fac$Female[j]/fac$Total[j], power=0.8)
effective_or_not[i,j] <-fac$Total[i] > ss_estimate$n & fac$Total[j] > ess_estimate$n
test <- prop.test(c(fac$Female[i], fac$Female[j]), c(fac$Total[i], fac$Total[j]))
z_output[i,j] = test$p.value
}
}
}
z_output <- matrix(0, nrow(fac), nrow(fac))
sample_size <- matrix(0, nrow(fac), nrow(fac))
effective_or_not <- matrix(0, nrow(fac), nrow(fac))
for(i in 1:nrow(fac)){
for(j in 1:nrow(fac)){
if(i != j){
print("hellow")
ss_estimate <- power.prop.test(p1 = fac$Female[i]/fac$Total[i], p2 = fac$Female[j]/fac$Total[j], power=0.8)
effective_or_not[i,j] <-fac$Total[i] > ss_estimate$n & fac$Total[j] > ess_estimate$n
test <- prop.test(c(fac$Female[i], fac$Female[j]), c(fac$Total[i], fac$Total[j]))
z_output[i,j] = test$p.value
}
}
}
z_output <- matrix(0, nrow(fac), nrow(fac))
sample_size <- matrix(0, nrow(fac), nrow(fac))
effective_or_not <- matrix(0, nrow(fac), nrow(fac))
for(i in 1:nrow(fac)){
for(j in 1:nrow(fac)){
if(i != j){
ss_estimate <- power.prop.test(p1 = fac$Female[i]/fac$Total[i], p2 = fac$Female[j]/fac$Total[j], power=0.8)
effective_or_not[i,j] <-fac$Total[i] > ss_estimate$n & fac$Total[j] > ss_estimate$n
test <- prop.test(c(fac$Female[i], fac$Female[j]), c(fac$Total[i], fac$Total[j]))
z_output[i,j] = test$p.value
}
}
}
effective_or_not
z_output <- matrix(0, nrow(fac), nrow(fac))
sample_size <- matrix(0, nrow(fac), nrow(fac))
effective_or_not <- matrix(0, nrow(fac), nrow(fac))
for(i in 1:nrow(fac)){
for(j in 1:nrow(fac)){
if(i != j){
ss_estimate <- power.prop.test(p1 = fac$Female[i]/fac$Total[i], p2 = fac$Female[j]/fac$Total[j], power=0.5)
effective_or_not[i,j] <-fac$Total[i] > ss_estimate$n & fac$Total[j] > ss_estimate$n
test <- prop.test(c(fac$Female[i], fac$Female[j]), c(fac$Total[i], fac$Total[j]))
z_output[i,j] = test$p.value
}
}
}
effective_or_not
power.prop.test(p1=60/155, p2=98/249, power=0.2)
power.prop.test(p1=60/155, p2=98/249, power=0.8)
power.prop.test(p1=60/155, p2=98/249, power=0.9)
z_output <- matrix(0, nrow(fac), nrow(fac))
sample_size <- matrix(0, nrow(fac), nrow(fac))
effective_or_not <- matrix(0, nrow(fac), nrow(fac))
for(i in 1:nrow(fac)){
for(j in 1:nrow(fac)){
if(i != j){
ss_estimate <- power.prop.test(p1 = fac$Female[i]/fac$Total[i], p2 = fac$Female[j]/fac$Total[j], power=0.5)
effective_or_not[i,j] <-fac$Total[i] > ss_estimate$n & fac$Total[j] > ss_estimate$n
test <- prop.test(c(fac$Female[i], fac$Female[j]), c(fac$Total[i], fac$Total[j]))
z_output[i,j] = test$p.value
}
}
}
sample_size
effective_or_not
z_output <- matrix(0, nrow(fac), nrow(fac))
effective_or_not <- matrix(0, nrow(fac), nrow(fac))
for(i in 1:nrow(fac)){
for(j in 1:nrow(fac)){
if(i != j){
ss_estimate <- power.prop.test(p1 = fac$Female[i]/fac$Total[i], p2 = fac$Female[j]/fac$Total[j], power=0.5)
effective_or_not[i,j] <-fac$Total[i] > ss_estimate$n & fac$Total[j] > ss_estimate$n
test <- prop.test(c(fac$Female[i], fac$Female[j]), c(fac$Total[i], fac$Total[j]))
z_output[i,j] = test$p.value
}
}
}
effective_or_not
?power.prop.test
z.output
z_output <- matrix(0, nrow(fac), nrow(fac))
effective_or_not <- matrix(0, nrow(fac), nrow(fac))
for(i in 1:nrow(fac)){
for(j in 1:nrow(fac)){
if(i != j){
ss_estimate <- power.prop.test(p1 = fac$Female[i]/fac$Total[i], p2 = fac$Female[j]/fac$Total[j], power=0.5)
effective_or_not[i,j] <-fac$Total[i] > ss_estimate$n & fac$Total[j] > ss_estimate$n
test <- prop.test(c(fac$Female[i], fac$Female[j]), c(fac$Total[i], fac$Total[j]))
z_output[i,j] = test$p.value
}
}
}
z_output
z_diag_removed <- z_output
diag(z_diag_removed) = NA
p_adj <- p.adjust(z_diag_removed, method="holm")
p_adj <- matrix(p_adj, nrow=14, ncol=14)
p_adj_df <- data.frame(p_adj)
p_adj_df
?argmin
??argmin
z_output <- matrix(0, nrow(fac), nrow(fac))
effective_or_not <- matrix(0, nrow(fac), nrow(fac))
for(i in 1:nrow(fac)){
for(j in 1:nrow(fac)){
if(i != j){
ss_estimate <- power.prop.test(p1 = fac$Female[i]/fac$Total[i], p2 = fac$Female[j]/fac$Total[j], power=0.8)
effective_or_not[i,j] <-fac$Total[i] > ss_estimate$n & fac$Total[j] > ss_estimate$n
test <- prop.test(c(fac$Female[i], fac$Female[j]), c(fac$Total[i], fac$Total[j]))
z_output[i,j] = test$p.value
}
}
}
# Diagnonal removed from bonferroni
z_diag_removed <- z_output
diag(z_diag_removed) = NA
p_adj <- p.adjust(z_diag_removed, method="bonferroni")
p_adj <- matrix(p_adj, nrow=14, ncol=14)
p_adj_df <- data.frame(p_adj)
p_adj_df
power.prop.test(p1 = 240/541, p2 = 98/111, power=0.8)
power.prop.test(p1 = 240/541, p2 = 9/17, power=0.8)
fig_4_loc <- "data/processed/figure_4_data.csv"
fac <- read.csv2(fig_4_loc, header=TRUE, sep=",")
fac_loc <- "data/processed/faculty.csv"
fac <- read.csv2(fac_loc, header=TRUE, sep=",")
fac$X[1] <- "eng"
fig_4_loc <- "data/processed/figure_4_data.csv"
fig_4 <- read.csv2(fig_4_loc, header=TRUE, sep=",")
fig_4
plot(fig_4$med.school, fig_4$senior.leadership)
med_school_senior_leadership_cor <- cor(fig_4$med.school, fig_4$senior.leadership)
med_school_senior_leadership_cor <- cor(fig_4)
med_school_senior_leadership_cor <- cov(fig_4)
is.numeric(fig_4$med.school[2])
fig_4$med.school[2]
as.numeric(fig_4)
lapply(fig_4, as.numeric)
fig_4[]< lapply(fig_4, as.numeric)
fig_4[]<-lapply(fig_4, as.numeric)
fig_4
fig_4_loc <- "data/processed/figure_4_data.csv"
fig_4 <- read.csv2(fig_4_loc, header=TRUE, sep=",")
fig_4[] <- lapply(df_4, as.numeric)
fig_4_loc <- "data/processed/figure_4_data.csv"
fig_4 <- read.csv2(fig_4_loc, header=TRUE, sep=",")
fig_4[] <- lapply(fig_4, as.numeric)
med_school_senior_leadership_cor <- cor(fig_4)
med_school_senior_leadership_cor
fig_4_cor <- cor(fig_4)
fit_med_senior <- lm(senior.leadership ~ med.school, data=fig_4)
fit_med_medfac <- lm(Med.Faculty.leadership ~ med.school, data= fig_4)
summary(fit_med_senior)
summary(fig_med_medfac)
fit_med_medfac <- lm(Med.Faculty.leadership ~ med.school, data= fig_4)
summary(fig_med_medfac)
fit_med_medfac
summary(fit_med_medfac)
fig_4_cor
p_adj_df
View(fit_med_senior)
